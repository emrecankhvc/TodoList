@inject Microsoft.AspNetCore.Mvc.Localization.IViewLocalizer Localizer
@model TodoProject.Models.TodoFilterViewModel
@using System.Globalization
@{
    ViewData["Title"] = @Localizer["PageTitle"];
    var userName = User.Identity?.Name ?? "Kullanıcı";
}

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">




    <!-- Main Content -->
    <div class="main-content">
        <div class="container-fluid py-5">
            <!-- Başlık Alanı -->
            <div class="d-flex justify-content-between align-items-center mb-5">
                <h2 class="gradient-text fw-bold display-4">
                    <i class="fas fa-tasks me-3"></i>@Localizer["PageTitle"]
                </h2>
                <a href="/Todo/Create" class="btn btn-gradient btn-lg shadow px-4 py-3 fs-4">
                    <i class="fas fa-plus-circle me-2"></i>@Localizer["AddTaskButton"]
                </a>
            </div>

            <!-- Filtreleme ve Sıralama Formu -->
            @await Html.PartialAsync("_TodoFilterPartial", Model)

            @if (!Model.Items.Any())
            {
                <div class="empty-state text-center py-5">
                    <i class="fas fa-clipboard-list fa-4x text-muted mb-3"></i>
                    <h4 class="text-muted fs-3">@Localizer["NoTasksMessage"]</h4>
                </div>
            }
            else
            {
                <div class="row row-cols-1 row-cols-md-2 row-cols-lg-4 g-4">
                    @foreach (var item in Model.Items)
                    {
                        <div class="col">
                        @await Html.PartialAsync("_TodoCardPartial", item)
                    </div>
                    }
                </div>
            }
        </div>


                                           
    </div>

                                      
</div>

@await Html.PartialAsync("_TodoNotePartial")


@await Html.PartialAsync("_TodoCalendarPartial")

@section Scripts {


    @if (TempData["SuccessMessage"] != null)
    {
        <script>
            toastr["success"]("@Localizer["Toast_Success_Message"]", "@Localizer["Toast_Success_Title"]");
        </script>
    }

    @if (TempData["InfoMessage"] != null)
    {
        <script>
            toastr["info"]("@Localizer["Toast_Info_Message"]", "@Localizer["Toast_Info_Title"]");
        </script>
    }

    @if (TempData["WarningMessage"] != null)
    {
        <script>
            toastr["warning"]("@Localizer["Toast_Warning_Message"]", "@Localizer["Toast_Warning_Title"]");
        </script>
    }

    <script src="~/js/todo-calendar.js" asp-append-version="true"></script>
    <script>
        function navigateToDetails(todoId) {
            window.location.href = '/Todo/Details/' + todoId;
        }
    </script>

    <script>
        // Takvim başlatma kodları
        document.addEventListener('DOMContentLoaded', function() {
            // Takvim konfigürasyonu
            const calendarConfig = {
                apiBaseUrl: '/Todo',
                localizations: {
                    tasks: '@Localizer["Tasks"]',
                    priorities: {
                        'High': '@Localizer["Priority_High"]',
                        'Medium': '@Localizer["Priority_Medium"]',
                        'Low': '@Localizer["Priority_Low"]'
                    },
                    statuses: {
                        'C': '@Localizer["Status_C"]',
                        'I': '@Localizer["Status_IP"]',
                        'U': '@Localizer["Status_UC"]'
                    }
                }
            };

            // Takvim başlat
            new TodoCalendar(calendarConfig);
        });
    </script>
 
    }